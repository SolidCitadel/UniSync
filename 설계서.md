# UniSync ì‹œìŠ¤í…œ ì„¤ê³„ì„œ

**ê°œë°œ í˜„í™©**: Phase 2 ì§„í–‰ ì¤‘ (Canvas ë™ê¸°í™” ë° SQS í†µí•©)

## êµ¬í˜„ í˜„í™© ìš”ì•½

### âœ… ì™„ë£Œ
- ê¸°ë³¸ ì¸í”„ë¼ ë° ì„œë¹„ìŠ¤ êµ¬ì¡°
- **API Gateway (Spring Cloud Gateway + JWT ì¸ì¦ + Cognito ì—°ë™)**
- Canvas Sync Lambda + SQS í†µí•©
- Course-Serviceì˜ SQS êµ¬ë… ë° Assignment ì²˜ë¦¬
- ê³µìœ  ëª¨ë“ˆ ê¸°ë°˜ DTO í‘œì¤€í™”
- E2E í†µí•© í…ŒìŠ¤íŠ¸ í™˜ê²½

### ğŸš§ ì§„í–‰ ì¤‘
- User-Service ì¸ì¦ ë° í† í° ê´€ë¦¬
- Schedule-Service ì¼ì • í†µí•©
- Step Functions ì›Œí¬í”Œë¡œìš°
- LLM Task ìë™ ìƒì„±

## 1. ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### 1.1 ì „ì²´ êµ¬ì¡°ë„
```
[Client - React]
       |
       | HTTPS
       |
[API Gateway - ALB + Cognito]
       |
       |--- [User-Service]        --- [MySQL - Users DB]
       |--- [Course-Service]      --- [MySQL - Courses DB]
       |--- [Schedule-Service]    --- [MySQL - Schedules DB]
       |
       |--- [Canvas-Sync-Workflow - Step Functions + Lambda] --- [SQS]
       |--- [Google-Calendar-Sync-Workflow - Step Functions + Lambda] --- [SQS]
       |--- [LLM-Lambda]
```

### 1.2 ì„œë¹„ìŠ¤ êµ¬ì„±
- **API Gateway**: ALB + AWS Cognito (ì¸ì¦/ì¸ê°€)
- **Backend Services**: Spring Boot ê¸°ë°˜ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ (3ê°œ)
  - User-Service: ì‚¬ìš©ì/ì¸ì¦/ì†Œì…œ
  - Course-Service: Canvas í•™ì—… ë°ì´í„°
  - Schedule-Service: ì‹œê°„ ê¸°ë°˜ ì¼ì • í†µí•©
- **Serverless Sync Components**: Step Functions + Lambda
  - Canvas-Sync-Workflow: Canvas API ë™ê¸°í™”
  - Google-Calendar-Sync-Workflow: Google Calendar ë™ê¸°í™”
  - LLM-Lambda: Task ìƒì„± ë° ì œì¶œë¬¼ ê²€ì¦
- **Data Layer**: MySQL (RDS) - ì„œë¹„ìŠ¤ë³„ DB ë¶„ë¦¬ (3ê°œ)
- **Message Queue**: AWS SQS
- **Event Bus**: AWS EventBridge

---

## 2. ë°ì´í„° ëª¨ë¸

### 2.1 User-Service

#### Users
```sql
CREATE TABLE users (
    user_id BIGINT PRIMARY KEY AUTO_INCREMENT,
    email VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(255),
    name VARCHAR(100) NOT NULL,
    canvas_user_id VARCHAR(100),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    INDEX idx_email (email)
);
```

#### Credentials
```sql
CREATE TABLE credentials (
    credential_id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL,
    provider ENUM('CANVAS', 'GOOGLE', 'TODOIST') NOT NULL,
    access_token TEXT NOT NULL,
    refresh_token TEXT,
    token_expires_at TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(user_id) ON DELETE CASCADE,
    UNIQUE KEY uk_user_provider (user_id, provider),
    INDEX idx_user_id (user_id)
);
```

#### Friendships
```sql
CREATE TABLE friendships (
    friendship_id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL,
    friend_id BIGINT NOT NULL,
    status ENUM('PENDING', 'ACCEPTED', 'BLOCKED') DEFAULT 'PENDING',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    UNIQUE KEY uk_user_friend (user_id, friend_id),
    INDEX idx_user_id (user_id),
    INDEX idx_friend_id (friend_id),
    INDEX idx_status (status),
    CHECK (user_id != friend_id)
);
```

### 2.2 Course-Service

#### Courses
```sql
CREATE TABLE courses (
    course_id BIGINT PRIMARY KEY AUTO_INCREMENT,
    canvas_course_id VARCHAR(100) UNIQUE NOT NULL,
    course_code VARCHAR(50),
    course_name VARCHAR(255) NOT NULL,
    semester VARCHAR(50),
    instructor VARCHAR(100),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    INDEX idx_canvas_course_id (canvas_course_id)
);
```

#### Enrollments
```sql
CREATE TABLE enrollments (
    enrollment_id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL,
    course_id BIGINT NOT NULL,
    canvas_enrollment_id VARCHAR(100),
    role ENUM('STUDENT', 'TA', 'INSTRUCTOR') DEFAULT 'STUDENT',
    is_sync_leader BOOLEAN DEFAULT FALSE,
    enrolled_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (course_id) REFERENCES courses(course_id) ON DELETE CASCADE,
    UNIQUE KEY uk_user_course (user_id, course_id),
    INDEX idx_user_id (user_id),
    INDEX idx_course_id (course_id),
    INDEX idx_sync_leader (course_id, is_sync_leader)
);
```

#### Assignments
```sql
CREATE TABLE assignments (
    assignment_id BIGINT PRIMARY KEY AUTO_INCREMENT,
    canvas_assignment_id VARCHAR(100) UNIQUE NOT NULL,
    course_id BIGINT NOT NULL,
    title VARCHAR(255) NOT NULL,
    description TEXT,
    due_date TIMESTAMP,
    points_possible DECIMAL(10, 2),
    submission_types VARCHAR(255),
    canvas_url VARCHAR(512),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (course_id) REFERENCES courses(course_id) ON DELETE CASCADE,
    INDEX idx_canvas_assignment_id (canvas_assignment_id),
    INDEX idx_course_id (course_id),
    INDEX idx_due_date (due_date)
);
```

#### Notices
```sql
CREATE TABLE notices (
    notice_id BIGINT PRIMARY KEY AUTO_INCREMENT,
    canvas_announcement_id VARCHAR(100) UNIQUE NOT NULL,
    course_id BIGINT NOT NULL,
    title VARCHAR(255) NOT NULL,
    message TEXT,
    posted_at TIMESTAMP,
    canvas_url VARCHAR(512),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (course_id) REFERENCES courses(course_id) ON DELETE CASCADE,
    INDEX idx_canvas_announcement_id (canvas_announcement_id),
    INDEX idx_course_id (course_id)
);
```

#### Tasks
```sql
CREATE TABLE tasks (
    task_id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL,
    assignment_id BIGINT,
    parent_task_id BIGINT,
    title VARCHAR(255) NOT NULL,
    description TEXT,
    due_date TIMESTAMP,
    status ENUM('TODO', 'IN_PROGRESS', 'DONE') DEFAULT 'TODO',
    priority ENUM('LOW', 'MEDIUM', 'HIGH') DEFAULT 'MEDIUM',
    is_ai_generated BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (assignment_id) REFERENCES assignments(assignment_id) ON DELETE CASCADE,
    FOREIGN KEY (parent_task_id) REFERENCES tasks(task_id) ON DELETE CASCADE,
    INDEX idx_user_id (user_id),
    INDEX idx_assignment_id (assignment_id),
    INDEX idx_parent_task_id (parent_task_id),
    INDEX idx_status (status),
    INDEX idx_due_date (due_date)
);
```

#### Sync_Status
```sql
CREATE TABLE sync_status (
    sync_id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL,
    provider ENUM('CANVAS', 'GOOGLE_CALENDAR', 'TODOIST') NOT NULL,
    last_synced_at TIMESTAMP,
    sync_state ENUM('IDLE', 'IN_PROGRESS', 'FAILED') DEFAULT 'IDLE',
    error_message TEXT,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    UNIQUE KEY uk_user_provider (user_id, provider),
    INDEX idx_user_id (user_id)
);
```

### 2.3 Schedule-Service

#### User_Schedules
```sql
CREATE TABLE user_schedules (
    schedule_id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL,
    title VARCHAR(255) NOT NULL,
    description TEXT,
    start_time TIMESTAMP,
    end_time TIMESTAMP NOT NULL,
    location VARCHAR(255),
    category VARCHAR(50),
    tags JSON,
    is_all_day BOOLEAN DEFAULT FALSE,
    recurrence_rule VARCHAR(255),
    source ENUM('CANVAS', 'GOOGLE_CALENDAR', 'TODOIST', 'USER') DEFAULT 'USER',
    source_id VARCHAR(255),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    INDEX idx_user_id (user_id),
    INDEX idx_start_time (start_time),
    INDEX idx_end_time (end_time),
    INDEX idx_source (source, source_id)
);
```

---

## 3. API ì„¤ê³„

### 3.1 User-Service API

#### ì¸ì¦ ë° íšŒì›
- `POST /api/users/register` - íšŒì›ê°€ì…
- `POST /api/users/login` - ë¡œê·¸ì¸
- `GET /api/users/profile` - í”„ë¡œí•„ ì¡°íšŒ
- `PUT /api/users/profile` - í”„ë¡œí•„ ìˆ˜ì •
- `DELETE /api/users/account` - ê³„ì • ì‚­ì œ

#### ì™¸ë¶€ ê³„ì • ì—°ë™
- `POST /api/users/credentials/canvas` - Canvas API í† í° ì €ì¥
  - Request Body: `{ "canvasToken": "string", "canvasUrl": "https://canvas.example.com" }`
- `POST /api/users/credentials/google` - Google ê³„ì • ì—°ë™ (OAuth2)
- `POST /api/users/credentials/todoist` - Todoist ê³„ì • ì—°ë™ (OAuth2)
- `GET /api/users/credentials` - ì—°ë™ëœ ê³„ì • ëª©ë¡
- `DELETE /api/users/credentials/{provider}` - ê³„ì • ì—°ë™ í•´ì œ

### 3.2 Course-Service API

#### ìˆ˜ê°• ê³¼ëª©
- `GET /api/courses` - ë‚´ ìˆ˜ê°• ê³¼ëª© ëª©ë¡
- `GET /api/courses/{courseId}` - ê³¼ëª© ìƒì„¸ ì •ë³´
- `POST /api/courses/sync` - Canvasì—ì„œ ê³¼ëª© ë™ê¸°í™”
- `GET /api/courses/{courseId}/students` - ê³¼ëª© ìˆ˜ê°•ìƒ ëª©ë¡

### 3.3 Sync-Service API

#### ê³¼ì œ ê´€ë¦¬
- `GET /api/assignments` - ê³¼ì œ ëª©ë¡ (í•„í„°ë§: ê³¼ëª©, ë§ˆê°ì¼, ìƒíƒœ)
- `GET /api/assignments/{assignmentId}` - ê³¼ì œ ìƒì„¸
  - Responseì— AI ìƒì„±ëœ task ëª©ë¡ í¬í•¨

#### Task ê´€ë¦¬
- `GET /api/tasks` - Task ëª©ë¡
- `POST /api/tasks` - Task ìƒì„±
- `PUT /api/tasks/{taskId}` - Task ìˆ˜ì •
- `DELETE /api/tasks/{taskId}` - Task ì‚­ì œ
- `PATCH /api/tasks/{taskId}/status` - Task ìƒíƒœ ë³€ê²½

#### ë™ê¸°í™”
- `POST /api/sync/trigger` - ìˆ˜ë™ ë™ê¸°í™” íŠ¸ë¦¬ê±°
- `GET /api/sync/status` - ë™ê¸°í™” ìƒíƒœ ì¡°íšŒ

#### ê³µì§€ì‚¬í•­
- `GET /api/notices` - ê³µì§€ì‚¬í•­ ëª©ë¡
- `GET /api/notices/{noticeId}` - ê³µì§€ ìƒì„¸

### 3.4 Schedule-Service API

#### ì¼ì • ê´€ë¦¬
- `GET /api/schedules` - ì¼ì • ëª©ë¡ (ë‚ ì§œ ë²”ìœ„, ì¹´í…Œê³ ë¦¬ í•„í„°)
- `POST /api/schedules` - ì¼ì • ìƒì„±
- `PUT /api/schedules/{scheduleId}` - ì¼ì • ìˆ˜ì •
- `DELETE /api/schedules/{scheduleId}` - ì¼ì • ì‚­ì œ

#### ê³µê°• ì°¾ê¸°
- `POST /api/schedules/find-free-slots` - ì—¬ëŸ¬ ì‚¬ìš©ì ê³µê°• ì‹œê°„ ê³„ì‚°
  - Request Body: `{ userIds: [1, 2, 3], startDate, endDate, minDuration }`
  - Response: ê²¹ì¹˜ì§€ ì•ŠëŠ” ì‹œê°„ëŒ€ ëª©ë¡

### 3.5 Social-Service API

#### ì¹œêµ¬ ê´€ë¦¬
- `GET /api/friends` - ì¹œêµ¬ ëª©ë¡
- `POST /api/friends/request` - ì¹œêµ¬ ìš”ì²­
- `PUT /api/friends/{friendshipId}/accept` - ì¹œêµ¬ ìˆ˜ë½
- `DELETE /api/friends/{friendshipId}` - ì¹œêµ¬ ì‚­ì œ/ê±°ì ˆ

#### ì¹œêµ¬ ì¶”ì²œ
- `GET /api/friends/recommendations` - ì¹œêµ¬ ì¶”ì²œ (ê°™ì€ ê³¼ëª© ìˆ˜ê°•ìƒ)

---

## 4. ì„œë¹„ìŠ¤ ê°„ í†µì‹ 

### 4.1 ë™ê¸° í†µì‹  (REST API)
- API Gatewayë¥¼ í†µí•œ í´ë¼ì´ì–¸íŠ¸ ìš”ì²­ì€ ë™ê¸° ì²˜ë¦¬
- ì„œë¹„ìŠ¤ ê°„ ì§ì ‘ í˜¸ì¶œì€ ìµœì†Œí™”
- í•„ìš” ì‹œ Service Discovery (Spring Cloud) ë˜ëŠ” ALB í™œìš©

### 4.2 ë¹„ë™ê¸° í†µì‹  (Event-Driven)

#### SQS í êµ¬ì„±
1. **assignment-events-queue**
   - Producer: Sync-Workflow (Step Functions)
   - Consumer: Sync-Service, LLM Lambda
   - Message: ìƒˆë¡œìš´ ê³¼ì œ/ê³µì§€ ì •ë³´ ë° AI ë¶„ì„ íŠ¸ë¦¬ê±°

2. **submission-events-queue**
   - Producer: Sync-Workflow (Step Functions)
   - Consumer: LLM Lambda
   - Message: ê³¼ì œ ì œì¶œë¬¼ ê²€ì¦ ìš”ì²­

3. **task-creation-queue**
   - Producer: LLM Lambda
   - Consumer: Sync-Service
   - Message: AI ìƒì„±ëœ task ì •ë³´

4. **external-sync-queue**
   - Producer: Sync-Service
   - Consumer: Sync-Workflow
   - Message: Google Calendar, Todoist ë™ê¸°í™” ìš”ì²­

#### EventBridge ì´ë²¤íŠ¸
- `AssignmentCreated` - ìƒˆ ê³¼ì œ ìƒì„± ì‹œ
- `AssignmentUpdated` - ê³¼ì œ ìˆ˜ì • ì‹œ
- `TaskCompleted` - Task ì™„ë£Œ ì‹œ
- `SyncFailed` - ë™ê¸°í™” ì‹¤íŒ¨ ì‹œ

---

## 5. ë™ê¸°í™” ì „ëµ

### 5.1 Canvas API ë™ê¸°í™”

#### í´ë§ ì£¼ê¸°
- **ì‹¤ì‹œê°„ ëª¨ë“œ**: 5ë¶„ë§ˆë‹¤ í´ë§ (EventBridge Scheduler)
- **ì ˆì „ ëª¨ë“œ**: ì‚¬ìš©ì ë¹„í™œì„± ì‹œ 30ë¶„ë§ˆë‹¤
- **ìˆ˜ë™ íŠ¸ë¦¬ê±°**: ì‚¬ìš©ì ìš”ì²­ ì‹œ ì¦‰ì‹œ

#### Leader ì„ ì¶œ ë°©ì‹
- ê³¼ëª©ë‹¹ í•œ ëª…ì˜ Leaderë§Œ Canvas API í˜¸ì¶œ (API ë¹„ìš© ì ˆê°)
- Course-Serviceê°€ Enrollment í…Œì´ë¸”ì—ì„œ `is_sync_leader` ê´€ë¦¬
- Leader ì„ ì¶œ ì¡°ê±´:
  1. í•´ë‹¹ ê³¼ëª©ì˜ ì²« ë²ˆì§¸ ì—°ë™ ì‚¬ìš©ì
  2. ê¸°ì¡´ Leaderê°€ ì—°ë™ í•´ì œ ì‹œ ë‹¤ìŒ ì‚¬ìš©ìë¡œ ìë™ ì´ê´€
- Leaderê°€ ì¡°íšŒí•œ ë°ì´í„°ëŠ” ëª¨ë“  ìˆ˜ê°•ìƒì—ê²Œ ê³µìœ 

#### ë³€ê²½ ê°ì§€
- Canvas APIì˜ `updated_at` í•„ë“œë¡œ ì¦ë¶„ ë™ê¸°í™”
- ë§ˆì§€ë§‰ ë™ê¸°í™” ì‹œê° ì´í›„ ë³€ê²½ëœ í•­ëª©ë§Œ ì¡°íšŒ
- Step Functionsì—ì„œ ì²˜ë¦¬:
  1. Canvas API í˜¸ì¶œ
  2. ë³€ê²½ ì‚¬í•­ ë¹„êµ
  3. ë³€ê²½ëœ í•­ëª©ë§Œ SQSë¡œ ì „ì†¡

### 5.2 ì™¸ë¶€ ì„œë¹„ìŠ¤ ì–‘ë°©í–¥ ë™ê¸°í™”

#### Google Calendar
- **UniSync â†’ Google**: ê³¼ì œ/ì¼ì • ìƒì„± ì‹œ Google Calendar API í˜¸ì¶œ
- **Google â†’ UniSync**: Google Calendar Webhook êµ¬ë…
  - Push Notification ìˆ˜ì‹ 
  - ë³€ê²½ ì‚¬í•­ Schedule-Serviceì— ë°˜ì˜

#### Todoist
- **UniSync â†’ Todoist**: Task ìƒì„±/ìˆ˜ì • ì‹œ Todoist API í˜¸ì¶œ
- **Todoist â†’ UniSync**: Webhook êµ¬ë… ë˜ëŠ” ì£¼ê¸°ì  í´ë§

#### ì¶©ëŒ í•´ê²° ì •ì±…
- **Last-Write-Wins**: ìµœì‹  ìˆ˜ì • ì‹œê° ê¸°ì¤€
- **User Preference**: ì„¤ì •ì—ì„œ ìš°ì„  ì†ŒìŠ¤ ì§€ì • (UniSync ìš°ì„  ë˜ëŠ” ì™¸ë¶€ ì„œë¹„ìŠ¤ ìš°ì„ )
- **Manual Resolution**: ì¶©ëŒ ë°œìƒ ì‹œ ì‚¬ìš©ìì—ê²Œ ì„ íƒ UI ì œê³µ

---

## 6. Sync-Workflow ì„¤ê³„ (Step Functions)

### 6.1 Canvas Sync Workflow
```
Start
  â†“
Get All Active Users with Canvas Credentials
  â†“
For Each Course (with Leader)
  â†“
  Lambda: Fetch Canvas Assignments, Announcements & Submissions
  â†“
  Lambda: Compare with DB (check updated_at)
  â†“
  New Assignment Detected?
    â†“ Yes
    Send to SQS (assignment-events-queue)
    â†’ Triggers LLM Lambda for Task Generation
  â†“
  Submission Detected?
    â†“ Yes
    Send to SQS (submission-events-queue)
    â†’ Triggers LLM Lambda for Validation
    â†’ If valid, update task status to DONE
  â†“
Continue to Next Course
  â†“
End

---
LLM Lambda (triggered by assignment-events-queue):
  1. Analyze assignment description
  2. Generate task and subtask JSON
  3. Send to SQS (task-creation-queue)
  â†’ Sync-Service consumes and creates tasks

LLM Lambda (triggered by submission-events-queue):
  1. Validate submission metadata
  2. Check file format, filename, count
  3. Return validation result
  â†’ Sync-Service updates task status if valid
```

### 6.2 External Sync Workflow (Google Calendar, Todoist)
```
Start
  â†“
Receive Event from SQS (external-sync-queue)
  â†“
Lambda: Call External API (create/update/delete)
  â†“
Success?
  â†“ Yes
  Update Sync Status
  â†“ No
  Retry (ìµœëŒ€ 3íšŒ)
  â†“
  Still Failed? â†’ Send Alert
  â†“
End
```

---

## 7. LLM ì„œë¹„ìŠ¤ ì„¤ê³„

### 7.1 Lambda í•¨ìˆ˜ êµ¬ì„±
- **Runtime**: Python 3.11
- **Timeout**: 30ì´ˆ
- **Memory**: 512MB

### 7.2 ê¸°ëŠ¥

#### 1) Subtask ìƒì„±
- **Input**: ê³¼ì œ ì„¤ëª… (í…ìŠ¤íŠ¸)
- **Output**: JSON í˜•íƒœì˜ subtask ëª©ë¡ (title, description, estimated_duration)
- SQS: `task-creation-queue`ë¡œ ì „ì†¡ â†’ Course-Serviceê°€ Task ìƒì„±

#### 2) ì œì¶œë¬¼ ìœ íš¨ì„± ê²€ì‚¬
- **Input**: ê³¼ì œ ì„¤ëª… + ì œì¶œë¬¼ ë©”íƒ€ë°ì´í„° (íŒŒì¼ëª…, í™•ì¥ì, íŒŒì¼ í¬ê¸°)
- **Output**: ìœ íš¨ì„± ê²€ì¦ ê²°ê³¼ (is_valid, issues, warnings)
- ê²€ì¦ í•­ëª©: íŒŒì¼ í˜•ì‹, íŒŒì¼ëª… ê·œì¹™, ì œì¶œë¬¼ ê°œìˆ˜

### 7.3 ë¹„ìš© ê´€ë¦¬
- ì‚¬ìš©ìë‹¹ ì›” LLM API í˜¸ì¶œ ì œí•œ
- ìºì‹±: ë™ì¼ ê³¼ì œì— ëŒ€í•œ ë¶„ì„ ê²°ê³¼ ìºì‹œ

---

## 8. ë³´ì•ˆ ì„¤ê³„

### 8.1 ì¸ì¦/ì¸ê°€
- **AWS Cognito**: ì‚¬ìš©ì ì¸ì¦ ë° JWT ë°œê¸‰
- **JWT ê²€ì¦**: API Gatewayì—ì„œ ìë™ ê²€ì¦
- **Role-Based Access Control**:
  - ë³¸ì¸ ë°ì´í„°ë§Œ ì ‘ê·¼ ê°€ëŠ¥
  - ì¹œêµ¬ ë°ì´í„°ëŠ” ê³µê°• ì°¾ê¸° ë“± ì œí•œì  ì ‘ê·¼

### 8.2 ë°ì´í„° ì•”í˜¸í™”
- **ì „ì†¡ ì¤‘**: HTTPS (TLS 1.2+)
- **ì €ì¥ ì¤‘**:
  - RDS ì•”í˜¸í™” í™œì„±í™”
  - access_token, refresh_tokenì€ AES-256 ì•”í˜¸í™” í›„ ì €ì¥

### 8.3 API í‚¤ ê´€ë¦¬
- **AWS Secrets Manager**:
  - Canvas API Token
  - Google OAuth Client Secret
  - Todoist API Key
  - LLM API Key
- Lambda ë° Spring Boot ì„œë¹„ìŠ¤ì—ì„œ ëŸ°íƒ€ì„ ì‹œ ì¡°íšŒ

### 8.4 Rate Limiting
- API Gatewayì—ì„œ ì‚¬ìš©ìë³„ Rate Limit ì„¤ì •
  - ì¼ë°˜ API: 100 req/min
  - LLM ë¶„ì„ API: 10 req/min

---

## 9. ë°°í¬ ì•„í‚¤í…ì²˜

### 9.1 AWS ì¸í”„ë¼

#### Compute
- **ECS Fargate**: Spring Boot ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì»¨í…Œì´ë„ˆ ì‹¤í–‰
  - User-Service: 2 tasks (CPU: 0.5 vCPU, Memory: 1GB)
  - Course-Service: 2 tasks
  - Sync-Service: 2 tasks
  - Schedule-Service: 2 tasks
  - Social-Service: 1 task
- **Lambda**: Sync-Workflow, LLM Service

#### Data
- **RDS MySQL**: ì„œë¹„ìŠ¤ë³„ DB (Multi-AZ êµ¬ì„±)
- **SQS**: ë©”ì‹œì§€ í
- **EventBridge**: ì´ë²¤íŠ¸ ìŠ¤ì¼€ì¤„ë§

#### Networking
- **ALB**: ë¡œë“œ ë°¸ëŸ°ì‹± ë° HTTPS ì¢…ë£Œ
- **VPC**: Private Subnet (ECS, RDS), Public Subnet (ALB)
- **Security Groups**: ì„œë¹„ìŠ¤ë³„ ìµœì†Œ ê¶Œí•œ ì›ì¹™

#### Monitoring
- **CloudWatch**: ë¡œê·¸ ìˆ˜ì§‘, ë©”íŠ¸ë¦­ ëª¨ë‹ˆí„°ë§
- **CloudWatch Alarms**: ì—ëŸ¬ìœ¨, ì‘ë‹µ ì‹œê°„ ì•Œë¦¼

### 9.2 CI/CD Pipeline (GitHub Actions)

```yaml
# .github/workflows/deploy.yml
on:
  push:
    branches: [main]

jobs:
  build:
    - Checkout code
    - Build Spring Boot JAR
    - Build Docker image
    - Push to ECR

  deploy:
    - Update ECS Task Definition
    - Deploy to ECS Fargate
    - Run health check
    - Rollback if failed
```

---

## 10. ê°œë°œ í™˜ê²½ ì„¤ì • (docker-compose + LocalStack)

### 10.1 ì£¼ìš” êµ¬ì„±
- **LocalStack**: SQS, Lambda, EventBridge, Cognito ì—ë®¬ë ˆì´ì…˜ (í¬íŠ¸: 4566)
- **MySQL**: ì„œë¹„ìŠ¤ë³„ DB (í¬íŠ¸: 3306)
- **Spring Boot Services**: User(8081), Course(8082), Schedule(8083)
- ìì„¸í•œ êµ¬ì„±ì€ [docker-compose.yml](./docker-compose.yml) ì°¸ê³ 

### 10.2 ë¡œì»¬ ê°œë°œ í”Œë¡œìš°
1. `docker-compose up` - ì „ì²´ í™˜ê²½ ì‹¤í–‰
2. LocalStackì—ì„œ SQS í, EventBridge ê·œì¹™ ìë™ ìƒì„±
3. MySQL ìŠ¤í‚¤ë§ˆ ìë™ ìƒì„± (Flyway/Liquibase)
4. Swagger UIì—ì„œ API í…ŒìŠ¤íŠ¸ (http://localhost:808x/swagger-ui.html)

---

## 11. ê¸°ìˆ  ìŠ¤íƒ ì •ë¦¬

### Frontend
- **React** 18+
- **TypeScript**
- **React Query** (ì„œë²„ ìƒíƒœ ê´€ë¦¬)
- **Zustand** (í´ë¼ì´ì–¸íŠ¸ ìƒíƒœ ê´€ë¦¬)
- **TailwindCSS** (ìŠ¤íƒ€ì¼ë§)
- **FullCalendar** (ìº˜ë¦°ë” UI)

### Backend
- **Spring Boot** 3.x
- **Spring Cloud** (Service Discovery)
- **Spring Data JPA**
- **Swagger/OpenAPI** 3.0
- **AWS SDK for Java** 2.x

### Infrastructure
- **Docker** & **docker-compose**
- **LocalStack** (ë¡œì»¬ AWS ì—ë®¬ë ˆì´ì…˜)
- **MySQL** 8.0
- **AWS**: ECS, Fargate, Lambda, SQS, EventBridge, RDS, ALB, Cognito, Secrets Manager

### DevOps
- **GitHub Actions** (CI/CD)
- **AWS ECR** (ì»¨í…Œì´ë„ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬)
- **CloudWatch** (ëª¨ë‹ˆí„°ë§)

---

## 12. ê°œë°œ ë‹¨ê³„ë³„ ìš°ì„ ìˆœìœ„

**Phase 1** (ì™„ë£Œ): User-Service, Course-Service ê¸°ë³¸ êµ¬ì¡°
**Phase 2** (ì§„í–‰ ì¤‘): Canvas ë™ê¸°í™”, SQS ì´ë²¤íŠ¸ ì²˜ë¦¬
**Phase 3** (ì˜ˆì •): LLM Lambda, Task ìë™ ìƒì„±
**Phase 4** (ì˜ˆì •): ì†Œì…œ ê¸°ëŠ¥, ê³µê°• ì°¾ê¸°
**Phase 5** (ì˜ˆì •): ì™¸ë¶€ ì„œë¹„ìŠ¤ ì—°ë™, ê³ ë„í™”

í˜„ì¬ ìƒíƒœëŠ” [CLAUDE.md](./CLAUDE.md#í”„ë¡œì íŠ¸-ê°œìš”) ì°¸ê³ 
